
# from constant import

setcode_list = [
[0x1, "A・O・J"],
[0x2, "ジェネクス"],
[0x1002, "レアル・ジェネクス"],
#setname 0x2002 A・ジェネクス"],
#setname 0x3 ―"],
[0x4, "アマゾネス"],
[0x5 ,"アルカナフォース"],
[0x6 ,"暗黒界"],
[0x7, "アンティーク・ギア"],
[0x8, "HERO"],
[0x3008, "E・HERO"],
[0x5008, "V・HERO"],
[0x6008, "E-HERO"],
[0xa008, "M・HERO"],
[0xc008, "D-HERO"],
[0x9, "ネオス"],
[0xa, "ヴェルズ"],
[0x100a, "インヴェルズ"],
[0xb, "インフェルニティ"],
[0xc, "エーリアン"],
[0xd, "セイバー"],
[0x100d, "X－セイバー"],
#setname 0x300d XX－セイバー"],
[0x400d, "エレメントセイバー"],
[0xe, "エレキ"],
[0xf, "おジャマ"],
[0x10, "ガスタ"],
[0x11, "カラクリ"],
[0x12, "ガエル"],
[0x13, "機皇"],
[0x3013, "機皇帝"],
[0x5013, "機皇神"],
[0x6013, "機皇兵"],
#setname 0x14 ―"],
[0x15, "巨大戦艦"],
[0x16, "ロイド"],
[0x1016, "ビークロイド"],
[0x2016, "スピードロイド"],
#[0x17 シンクロ"],
[0x1017, "シンクロン"],
[0x2017, "シンクロ・ドラゴン"],
[0x18, "雲魔物"],
[0x19, "剣闘獣"],
[0x1a, "黒蠍"],
[0x1b, "幻獣"],
[0x101b, "幻獣機"],
[0x1c, "死のメッセージ"],
[0x1d, "コアキメイル"],
[0x1e, "C（コクーン）"],
[0x1f, "Ｎ（ネオスペーシアン）"],
[0x20, "紫炎"],
[0x21, "地縛神"],
[0x22, "ジュラック"],
[0x23, "Sin"],
[0x24, "スクラップ"],
[0x25, "C（チェーン）"],
[0x26, "D"],
[0x27, "TG"],
[0x28, "電池メン"],
[0x29, "ドラグニティ"],
[0x2a, "ナチュル"],
[0x2b, "忍者"],
[0x2c, "フレムベル"],
#setname 0x2d ―"],
[0x2e, "墓守"],
[0x2f, "氷結界"],
[0x30, "ヴァイロン"],
[0x31, "フォーチュンレディ"],
[0x32, "ヴォルカニック"],
[0x33, "BF"],
[0x1033, "A BF"],
[0x34, "宝玉"],
[0x1034, "宝玉獣"],
[0x2034, "究極宝玉神"],
[0x35, "魔轟神"],
[0x36, "マシンナーズ"],
[0x37, "ミスト・バレー"],
[0x38, "ライトロード"],
[0x39, "ラヴァル"],
[0x3a, "リチュア"],
[0x3b, "レッドアイズ"],
[0x3c, "レプティレス"],
[0x3d, "六武衆"],
[0x103d, "影六武衆"],
[0x3e, "ワーム"],
[0x3f, "セイヴァー"],
[0x40, "封印されし"],
[0x41, "LV"],
[0x42, "極星"],
[0x3042,"極星天"],
[0x6042, "極星獣"],
[0xa042, "極星霊"],
[0x5042, "極星宝"],
[0x43, "ジャンク"],
[0x44, "代行者"],
[0x45, "デーモン"],
[0x1045, "レッド・デーモン"],
[0x46, "融合／フュージョン"],
[0x1046, "フュージョン・ドラゴン"],
[0x47, "ジェム"],
[0x1047, "ジェムナイト"],
[0x48, "No."],
[0x1048, "CNo."],
[0x49, "銃士"],
[0x4a, "時械神"],
[0x4b, "極神"],
[0x4c, "落とし穴"],
#setname 0x4d ―"],
#setname 0x4e エヴォル"],
[0x304e, "エヴォルド"],
[0x604e, "エヴォルダー"],
[0x504e, "エヴォルカイザー"],
#setname 0x4f バスター"],
[0x104f, "／バスター"],
[0x50, "ヴェノム"],
[0x1050, "スターヴ・ヴェノム"],
[0x51, "ガジェット"],
[0x52, "ガーディアン"],
[0x53, "セイクリッド"],
[0x54, "ガガガ"],
[0x55, "フォトン"],
[0x56, "甲虫装機"],
[0x57, "リゾネーター"],
[0x58, "ゼンマイ"],
[0x59, "ゴゴゴ"],
[0x5a, "ペンギン"],
[0x5b, "トマボー"],
[0x5c, "スフィンクス"],
#setname 0x5d ―"],
#setname 0x5e ―"],
#setname 0x5f ―"],
[0x60, "竹光"],
[0x61, "忍法"],
[0x62, "トゥーン"],
[0x63, "リアクター"],
[0x64, "ハーピィ"],
[0x65, "侵略の"],
[0x66, "ウォリアー"],
[0x1066, "音響戦士"],
[0x2066, "マグネット・ウォリアー"],
#setname 0x67 アイアン"],
#setname 0x68 ブリキ"],
[0x69, "聖刻"],
[0x6a, "幻蝶の刺客"],
[0x6b, "バウンサー"],
#setname 0x6c ライトレイ"],
[0x6d, "魔人"],
[0x6e, "魔導"],
[0x106e, "魔導書"],
[0x6f, "ヒロイック"],
[0x106f, "H・C"],
#setname 0x206f H－C"],
[0x70, "先史遺産"],
[0x71, "マドルチェ"],
[0x72, "ギアギア"],
[0x1072, "ギアギアーノ"],
[0x73, "エクシーズ"],
[0x1073, "CX"],
[0x2073, "エクシーズ・ドラゴン"],
[0x74, "水精鱗"],
[0x75, "アビス"],
[0x76, "紋章獣"],
[0x77, "海皇"],
[0x78, "素早い"],
[0x79, "炎星"],
#setname 0x7a 聖"],
[0x107a, "聖騎士"],
[0x207a, "聖剣"],
[0x7b, "ギャラクシー"],
[0x107b, "ギャラクシーアイズ"],
[0x307b, "ギャラクシーアイズ・タキオン・ドラゴン"],
[0x7c, "炎舞"],
[0x7d, "ヘイズ"],
[0x107d, "陽炎獣"],
[0x7e, "ゼアル"],
[0x107e, "ＺＷ"],
[0x207e, "ＺＳ"],
[0x7f, "ホープ"],
[0x107f, "希望皇ホープ"],
[0x207f, "未来皇ホープ"],
[0x80, "ダストン"],
[0x81, "炎王"],
[0x1081, "炎王獣"],
[0x82, "ドドド"],
[0x83, "ギミック・パペット"],
[0x84, "BK"],
[0x85, "SDロボ"],
[0x86, "光天使"],
[0x87, "アンブラル"],
[0x88, "武神"],
[0x89, "ホール"],
#setname 0x8a 蟲惑"],
[0x108a, "蟲惑魔"],
[0x8b, "マリスボラス"],
#setname 0x8c ドルイド"],
[0x8d, "ゴーストリック"],
[0x8e, "ヴァンパイア"],
[0x8f, "ズババ"],
[0x90, "森羅"],
[0x91, "ネクロバレー"],
[0x92, "メダリオン"],
[0x93, "サイバー"],
[0x1093, "サイバー・ドラゴン"],
[0x2093, "サイバー・エンジェル"],
[0x4093, "サイバー・ダーク"],
[0x94, "サイバネティック"],
[0x95, "RUM"],
[0x96, "フィッシュボーグ"],
[0x97, "アーティファクト"],
[0x98, "魔術師"],
[0x99, "オッドアイズ"],
[0x9a, "超重武者"],
[0x109a, "超重武者装留"],
[0x9b, "幻奏"],
[0x109b, "幻奏の音姫"],
[0x9c, "テラナイト"],
[0x109c, "ステラナイト"],
[0x9d, "シャドール"],
[0x9e, "竜星"],
[0x9f, "EM"],
[0xa0, "伝説の騎士"],
[0xa1, "伝説の竜"],
#setname 0xa2 マジシャン"],
[0x10a2, "ブラック・マジシャン"],
[0x20a2, "マジシャン・ガール"],
[0x30a2, "ブラック・マジシャン・ガール"],
[0xa3, "スターダスト"],
[0xa4, "クリボー"],
[0x10a4, "ハネクリボー"],
[0xa5, "チェンジ"],
[0xa6, "スプラウト"],
[0xa7, "アルトリウス"],
[0xa8, "ランスロット"],
[0xa9, "ファーニマル"],
[0xaa, "クリフォート"],
[0x10aa, "アポクリフォート"],
[0xab, "ブンボーグ"],
[0xac, "ゴブリン"],
[0xad, "デストーイ"],
[0xae, "契約書"],
[0xaf, "DD"],
[0x10af, "DDD"],
[0xb0, "ガトムズ"],
[0xb1, "彼岸"],
[0xb2, "U.A."],
[0xb3, "妖仙獣"],
[0xb4, "影霊衣"],
[0xb5, "霊獣"],
[0x10b5, "霊獣使い"],
[0x20b5, "精霊獣"],
#[0x30b5 精霊獣使い"],
[0x40b5, "聖霊獣騎"],
[0xb6, "外神"],
[0xb7, "旧神"],
[0xb8, "古神"],
[0xb9, "ブレイズ・キャノン"],
[0xba, "RR"],
[0xbb, "インフェルノイド"],
[0xbc, "人造人間"],
[0xbd, "暗黒騎士ガイア"],
[0xbe, "帝王"],
[0xbf, "霊使い"],
[0xc0, "憑依"],
[0x10c0, "憑依装着"],
[0xc1, "PSYフレーム"],
[0x10c1, "PSYフレームギア"],
[0xc2, "パワー・ツール"],
[0xc3, "エッジインプ"],
[0xc4, "セフィラ"],
[0xc5, "煉獄"],
[0xc6, "Em"],
[0xc7, "竜剣士"],
[0xc8, "イグナイト"],
[0xc9, "アロマ"],
[0xca, "魔装戦士"],
[0xcb, "イーサルウェポン"],
[0xcc, "占術姫"],
[0xcd, "アクアアクトレス"],
[0xce, "アクアリウム"],
[0xcf, "カオス"],
[0x10cf, "カオス・ソルジャー"],
[0xd0, "マジェスペクター"],
[0xd1, "グレイドル"],
[0xd2, "Kozmo"],
[0xd3, "壊獣"],
[0xd4, "バージェストマ"],
[0xd5, "ダンテ"],
[0xd6, "破壊剣"],
[0xd7, "バスター・ブレイダー"],
[0xd8, "ダイナミスト"],
[0xd9, "不知火"],
[0x10d9, "妖刀－不知火"],
[0xda, "竜魔王"],
[0xdb, "ファントム"],
[0x10db, "幻影騎士団"],
[0xdc, "超量"],
[0x10dc, "超量士"],
[0x20dc, "超量機獣"],
[0xdd, "ブルーアイズ"],
[0xde, "エクゾディア"],
[0xdf, "ムーンライト"],
[0xe0, "アモルファージ"],
[0xe1, "メタルフォーゼ"],
[0xe2, "トラミッド"],
[0xe3, "方界"],
[0xe4, "エルフの剣士"],
[0xe5, "サイファー"],
[0x10e5, "サイファー・ドラゴン"],
[0xe6, "花札衛"],
[0xe7, "サイレント・ソードマン"],
[0xe8, "サイレント・マジシャン"],
[0xe9, "磁石の戦士"],
[0xea, "クリストロン"],
[0xeb, "化合獣"],
#[0xec 魔界"],
[0x10ec, "魔界劇団"],
[0x20ec, "魔界台本"],
[0xed, "サブテラー"],
[0x10ed, "サブテラーマリス"],
[0xee, "SPYRAL"],
[0x10ee, "SPYRAL GEAR"],
[0x20ee, "SPYRAL MISSION"],
[0xef, "堕天使"],
[0xf0, "WW"],
[0xf1, "十二獣"],
[0xf2, "ペンデュラム"],
[0x10f2, "ペンデュラム・ドラゴン"],
[0x20f2, "ペンデュラムグラフ"],
[0xf3, "プレデター"],
[0x10f3, "捕食植物"],
[0xf4, "召喚獣"],
[0xf5, "ガンドラ"],
[0xf6, "摩天楼"],
[0xf7, "LL"],
#[0xf8 覇王"],
[0x10f8, "覇王門"],
[0x20f8, "覇王眷竜"],
[0xf9, "真竜"],
[0xfa, "幻煌龍"],
[0xfb, "トリックスター"],
[0xfc, "剛鬼"],
[0xfd, "星杯"],
[0xfe, "星遺物"],
[0xff, "クリアウィング"],
[0x100, "ボンディング"],
[0x101, "コード・トーカー"],
[0x102, "ヴァレット"],
[0x103, "オルターガイスト"],
[0x104, "クローラー"],
[0x105, "メタファイズ"],
[0x106, "ヴェンデット"],
[0x107, "F.A."],
[0x108, "魔弾"],
[0x109, "天気"],
[0x10a, "パーシアス"],
[0x10b, "ティンダングル"],
[0x10c, "ジャックナイツ"],
[0x10d, "魔導獣"],
[0x10e, "進化薬"],
[0x10f, "ヴァレル"],
[0x110, "サクリファイス"],
[0x1110, "アイズ・サクリファイス"],
[0x111, "アームド・ドラゴン"],
[0x112, "トロイメア"],
[0x113, "霊神"],
[0x114, "空牙団"],
[0x115, "閃刀"],
[0x1115, "閃刀姫"],
[0x116, "パラディオン"],
[0x117, "魔神儀"],
[0x118, "サイバネット"],
[0x119, "サラマングレイト"],
[0x11a, "ダイナレスラー"],
[0x11b, "オルフェゴール"],
[0x11c, "サンダー・ドラゴン"],
[0x11d, "禁じられた"],
[0x11e, "未界域"],
[0x11f, "ネフティス"],
[0x120, "プランキッズ"],
[0x121, "魔妖"],
[0x122, "ワルキューレ"],
[0x123, "ローズ"],
[0x1123, "ローズ・ドラゴン"],
[0x124, "機械天使"],
[0x125, "スマイル"],
[0x126, "クロノダイバー"],
[0x127, "無限起動"],
[0x128, "ウィッチクラフト"],
[0x129, "呪眼"],
[0x12a, "エンディミオン"],
[0x12b, "マリンセス"],
[0x12c, "天威"],
[0x12d, "シムルグ"],
[0x12e, "占い魔女"],
[0x12f, "B・F"],
[0x130, "破械"],
[0x1130, "破械神"],
[0x131, "夢魔鏡"],
[0x132, "斬機"],
[0x133, "ドラゴンメイド"],
[0x134, "ジェネレイド"],
[0x135, "@イグニスター"],
[0x136, "Ai"],
[0x137, "戦華"],
[0x138, "メガリス"],
[0x139, "守護神官"],
[0x13a, "オノマト"],
[0x13b, "リベリオン"],
[0x13c, "コードブレイカー"],
[0x13d, "ネメシス"],
[0x13e, "バルバロス"],
[0x13f, "海造賊"],
[0x140, "アダマシア"],
[0x141, "六花"],
[0x1142, "エルドリッチ"],
[0x2142, "エルドリクシル"],
[0x143, "黄金郷"],
[0x144, "幻魔"],
[0x145, "ドラグマ"],
[0x146, "メルフィー"],
[0x147, "ポータン"],
[0x148, "ローラン"],
[0x149, "化石"],
[0x14a, "ヌメロン"],
[0x114a, "ゲート・オブ・ヌメロン"],
[0x14b, "機塊"],
[0x314c, "地霊術"],
[0x514c, "水霊術"],
[0x614c, "火霊術"],
[0x914c, "風霊術"],
[0x14d, "トライブリゲード"],
[0x14e, "電脳堺"],
[0x114e, "電脳堺門"],
[0x14f, "双天"],
[0x150, "マギストス"],
[0x1151, "ライブツイン"],
[0x2151, "イビルツイン"],
[0x152, "キスキル"],
[0x153, "リィラ"],
[0x154, "ドライトロン"],
[0x155, "スプリガンズ"],
[0x156, "Ｓ－Ｆｏｒｃｅ"],
[0x157, "Myutant"],
[0x1158, "サンヴァイン"],
[0x2158, "サンアバロン"],
[0x159, "ホーリーナイツ"],
[0x15a, "ドール・モンスター"],
[0x15b, "アメイズメント"],
[0x15c, "アトラクション"],
[0x15d, "烙印"],
[0x15e, "ＲＤＭ"],
[0x15f, "War Rock"],
[0x160, "Materiactor"],
[0x161, "溟界"],
[0x162, "ドレミコード"],
[0x163, "ベアルクティ"],
[0x164, "デスピア"],
[0x165, "魔鍵"],
[0x166, "軍貫"],
[0x1167, "森の聖獣"],
[0x2167, "森の聖霊"]
]

type_list = [
    ["モンスター",0x1],
    ["魔法",0x2],
    ["罠",0x4],
    ["通常",0x10],
    ["効果",0x20],
    ["融合",0x40],
    ["儀式",0x80],
    ["罠モンスター",0x100],
    ["スピリット",0x200],
    ["ユニオン",0x400],
    ["デュアル",0x800],
    ["チューナー",0x1000],
    ["シンクロ",0x2000],
    ["トークン",0x4000],
    ["速攻",0x10000],
    ["永続",0x20000],
    ["装備",0x40000],
    ["フィールド",0x80000],
    ["カウンター",0x100000],
    ["リバース",0x200000],
    ["トゥーン",0x400000],
    ["エクシーズ",0x800000],
    ["ペンデュラム",0x1000000],
    ["特殊召喚",0x2000000],
    ["リンク",0x4000000]
]

race_list =[
    ["全種",0x1ffffff],
    ["戦士",0x1],
    ["魔法使い",0x2],
    ["天使",0x4],
    ["悪魔",0x8],
    ["アンデット",0x10],
    ["機械",0x20],
    ["水",0x40],
    ["炎",0x80],
    ["岩石",0x100],
    ["鳥獣",0x200],
    ["植物",0x400],
    ["昆虫",0x800],
    ["雷",0x1000],
    ["ドラゴン",0x2000],
    ["獣",0x4000],
    ["獣戦士",0x8000],
    ["恐竜",0x10000],
    ["魚",0x20000],
    ["海竜",0x40000],
    ["爬虫類",0x80000],
    ["サイキック",0x100000],
    ["幻神獣",0x200000],
    ["創造神",0x400000],
    ["幻竜",0x800000],
    ["サイバース",0x1000000]
]

attribute_list=[
    ["地",0x01],
    ["水",0x02],
    ["炎",0x04],
    ["風",0x08],
    ["光",0x10],
    ["闇",0x20],
    ["神",0x40]    
]
def parse_setcode(setcode):
    rtn_setcode_list = list()
    for sl in setcode_list:
        
        if (setcode & sl[0]) > 0:
            rtn_setcode_list.append(sl[1])
    return rtn_setcode_list

def parse_type(type):
    rtn_type_list = list()
    for tl in type_list:
        #print(type,tl[0])
        if (type & tl[1] )>0:
            rtn_type_list.append(tl[0])
    return rtn_type_list

def parse_race(race):
    rtn_race_list = list()
    for rl in race_list:
        if (race & rl[1])>0:
            rtn_race_list.append(rl[0])
    return rtn_race_list

def parse_attribute(attribute):
    rtn_attribute_list = list()
    for al in attribute_list:
        if (attribute & al[1])>0:
            rtn_attribute_list.append(al[0])
    return rtn_attribute_list

def parse_card_data(card_df):
    parsed_data=dict()
    #parsed_data["set_code"] = parse_set_code(card_df["set_code"])
    parsed_data["type"]  = parse_type(card_df["type"].values)
    parsed_data["race"] = parse_race(card_df["race"].values)
    parsed_data["attribute"] = parse_attribute(card_df["attribute"].values)
    return parsed_data

def check_extra(card_df):
    isExtra = False
    parsed_type  = parse_type(card_df["type"].values)
    for pt in parsed_type:
        if pt in ["融合","シンクロ", "エクシーズ","リンク"]:
            isExtra = True
            break
    return isExtra